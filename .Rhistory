final_record_df %>%
group_by(division) %>%
top_n(1, desc(rank)) %>%
arrange(rank) %>%
# recombine with the remaining teams
bind_rows(anti_join(final_record_df, .) %>%
arrange(rank)) %>%
select(-rank) %>%
add_rownames("rank") %>%
select(rank, team)
}
get_ranking <- function(final_record_df) {
# rank all teams by number of wins; break ties randomly (this step may not
# be necessary..)
final_record_df <- final_record_df %>%
mutate(rank = rank(desc(wins)))
# select the top teams from each division and rank by number of wins
final_record_df %>%
group_by(division) %>%
top_n(1, desc(rank)) %>%
arrange(rank) %>%
# recombine with the remaining teams
bind_rows(anti_join(final_record_df, .) %>%
arrange(rank)) %>%
select(-rank) %>%
add_rownames("rank") %>%
select(rank, team)
}
contenders %>% get_ranking()
contenders
contenders %>% ungroup() %>% get_ranking()
get_ranking <- function(final_record_df) {
# rank all teams by number of wins; break ties randomly (this step may not
# be necessary..)
#   final_record_df <- final_record_df %>%
#     mutate(rank = rank(desc(wins)))
# select the top teams from each division and rank by number of wins
final_record_df %>%
group_by(division) %>%
top_n(1, desc(wins)) %>%
arrange(desc(wins)) %>%
# recombine with the remaining teams
bind_rows(anti_join(final_record_df, .) %>%
arrange(rank)) %>%
select(-rank) %>%
add_rownames("rank") %>%
select(rank, team)
}
contenders %>% ungroup() %>% get_ranking()
contenders %>% get_ranking()
get_ranking <- function(final_record_df) {
# rank all teams by number of wins; break ties randomly (this step may not
# be necessary..)
#   final_record_df <- final_record_df %>%
#     mutate(rank = rank(desc(wins)))
# select the top teams from each division and rank by number of wins
final_record_df %>%
group_by(division) %>%
top_n(1, wins) %>%
arrange(desc(wins)) %>%
# recombine with the remaining teams
bind_rows(anti_join(final_record_df, .) %>%
arrange(rank)) %>%
select(-rank) %>%
add_rownames("rank") %>%
select(rank, team)
}
contenders %>% get_ranking()
get_ranking <- function(final_record_df) {
# rank all teams by number of wins; break ties randomly (this step may not
# be necessary..)
#   final_record_df <- final_record_df %>%
#     mutate(rank = rank(desc(wins)))
# select the top teams from each division and rank by number of wins
final_record_df %>%
group_by(division) %>%
top_n(1, wins) %>%
arrange(desc(wins)) %>%
# recombine with the remaining teams
bind_rows(anti_join(final_record_df, .) %>%
arrange(rank)) %>%
select(-rank) %>%
add_rownames("rank") %>%
select(rank, division, team)
}
contenders %>% get_ranking()
get_ranking <- function(final_record_df) {
# rank all teams by number of wins; break ties randomly (this step may not
# be necessary..)
#   final_record_df <- final_record_df %>%
#     mutate(rank = rank(desc(wins)))
# select the top teams from each division and rank by number of wins
final_record_df %>%
group_by(division) %>%
top_n(1, wins) %>%
arrange(desc(wins)) #%>%
# recombine with the remaining teams
#     bind_rows(anti_join(final_record_df, .) %>%
#                 arrange(rank)) %>%
#     select(-rank) %>%
#     add_rownames("rank") %>%
#     select(rank, division, team)
}
contenders %>% get_ranking()
contenders
contenders <- y %>%
mutate(outcome = ifelse(outcome == 0, home, away)) %>%
count_wins() %>%
update_records(record_df, .) %>%
mutate(rank = rank(desc(wins))) %>%
arrange(rank) %>%
filter(rank <= 4) %>%
select(-rank)
contenders
source('~/code/github/projects/ffb/R/predict_standings.R', echo=TRUE)
View(cumsum_df)
knitr::kable(cumsum_df)
library(dplyr)
library(tibble)
library(ggplot2)
x <- 1
x
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10)
)
survey_results
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4)
as.data.frame(survey_results)
data_frame(survey_results)
library(tidyr)
data_frame(survey_results) %>%
unnest(survey_results)
as_data_frame(survey_results) %>%
unnest(survey_results)
as_data_frame(survey_results)
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4)
)
survey_results
as_data_frame(survey_results)
as_data_frame(survey_results) %>%
unnest(Tony)
survey_results
library(purrr)
survey_results %>%
map_df()
?map_df
survey_results
?as_data_frame
survey_results %>%
as_tibble()
survey_results %>%
lapply(as_data_frame)
survey_results %>%
lapply(as_data_frame) %>%
as_data_frame()
survey_results %>%
lapply(as_data_frame) %>%
as_tibble()
survey_results %>%
lapply(as_data_frame)
survey_results %>%
lapply(as_data_frame) %>%
bind_rows()
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevi = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
survey_results %>%
lapply(as_data_frame) %>%
bind_rows()
survey_results %>%
lapply(as_data_frame)
survey_results %>%
lapply(nested(as_data_frame))
survey_results
survey_results %>%
as_tibble()
survey_results %>%
map_df(as_tibble)
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
survey_results %>%
map_df(as_tibble)
survey_results %>%
map(as_tibble)
survey_results %>%
map(as_tibble) %>%
map_df(as_tibble)
survey_results %>%
map(as_tibble) %>%
as_tibble()
survey_results %>%
map(as_tibble)
survey_results %>%
map(function(x) as_tibble(x))
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
})
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
bind_cols()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
bind_rows()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
as_tibble()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
map_df()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
as.data.frame()
})
})
d
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
})
?walk
})
d
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
})
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
flatten()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
transpose()
survey_results %>%
cross_d()
survey_results %>%
transpose()
survey_results %>%
flatten_df()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
flatten_df()
})
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
})
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
reduce()
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
}) %>%
walk()
})
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
survey_results %>%
map(function(x) {
as_tibble(x) %>%
gather(rival, rank)
})
as_tibble(y) %>%
gather(rival, rank)
as_tibble(x) %>%
gather(rival, rank)
as_tibble(x) %>%
gather(rival, rank)
?map2
as_tibble(y) %>%
gather(rival, rank)
map2(survey_results, names(survey_results), function(x, y) {
as_tibble(y) %>%
gather(rival, rank)
})
as_tibble(x) %>%
gather(rival, rank)
x
y
y
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
map2(survey_results, names(survey_results), function(x, y) {
y
})
?map2
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
map2(survey_results, names(survey_results), function(x, y) {
as_tibble(x)
})
?map2
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
map2(survey_results, names(survey_results), function(x, y) {
as_tibble(x) %>%
gather(rival, rank)
})
?map2
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
map2(survey_results, names(survey_results), function(x, y) {
as_tibble(x) %>%
gather(rival, rank) %>%
mutate(owner = y)
})
?map2
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11)
)
map2(survey_results, names(survey_results), function(x, y) {
as_tibble(x) %>%
gather(rival, rank) %>%
mutate(owner = y)
}) %>%
bind_rows()
?map2
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11),
Matt = list(James = 9, Brad = 5, Kevin = 3, Shep = 10, Drew = 8, Tony = 4,
Milf = 11, Keith = 12, Matt = 1, Toby = 7, Ross = 6, Billy = 2),
Milf = list(James = 10, Brad = 4, Kevin = 5, Shep = 9, Drew = 11, Tony = 7,
Milf = 12, Keith = 3, Matt = 6, Toby = 8, Ross = 1, Billy = 2),
Toby = list(James = 3, Brad = 1, Kevin = 11, Shep = 5, Drew = 2, Tony = 9,
Milf = 10, Keith = 8, Matt = 7, Toby = 12, Ross = 6, Billy = 4),
James = list(James = 12, Brad = 4, Kevin = 3, Shep = 2, Drew = 7, Tony = 1,
Milf = 9, Keith = 6, Matt = 8, Toby = 5, Ross = 11, Billy = 10),
Brad = list(James = 3, Brad = 12, Kevin = 6, Shep = 10, Drew = 1, Tony = 2,
Milf = 9, Keith = 7, Matt = 5, Toby = 11, Ross = 4, Billy = 8),
Ross = list(James = 9, Brad = 7, Kevin = 5, Shep = 12, Drew = 11, Tony = 6,
Milf = 3, Keith = 8, Matt = 4, Toby = 10, Ross = 1, Billy = 2),
Keith = list(James = 9, Brad = 3, Kevin = 1, Shep = 4, Drew = NA, Tony = 8,
Milf = 7, Keith = NA, Matt = 2, Toby = 6, Ross = 5, Billy = 10),
Shep = list(James = 8, Brad = 3, Kevin = 6, Shep = 1, Drew = NA, Tony = 10,
Milf = 9, Keith = 2, Matt = 11, Toby = 5, Ross = 12, Billy = 4),
Drew = list(James = 7, Brad = 2, Kevin = 4, Shep = 10, Drew = 1, Tony = 3,
Milf = 12, Keith = 11, Matt = 8, Toby = 6, Ross = 9, Billy = 5),
Kevin = list(James = 7, Brad = 6, Kevin = 12, Shep = 8, Drew = 9, Tony = 3,
Milf = 4, Keith = 1, Matt = 2, Toby = 5, Ross = 10, Billy = 11)
)
map2(survey_results, names(survey_results), function(x, y) {
as_tibble(x) %>%
gather(rival, rank) %>%
mutate(owner = y)
}) %>%
bind_rows()
choices <- c("James", "Brad", "Kevin", "Shep", "Drew", "Tony", "Milf",
"Keith", "Matt", "Toby", "Ross", "Billy")
survey_results <- list(
Tony = list(James = 1, Brad = 3, Kevin = 6, Shep = 10, Drew = 11, Tony = 12,
Milf = 8, Keith = 7, Matt = 2, Toby = 9, Ross = 5, Billy = 4),
Billy = list(James = 9, Brad = 6, Kevin = 4, Shep = 10, Drew = 8, Tony = 5,
Milf = 7, Keith = 3, Matt = 2, Toby = 12, Ross = 1, Billy = 11),
Matt = list(James = 9, Brad = 5, Kevin = 3, Shep = 10, Drew = 8, Tony = 4,
Milf = 11, Keith = 12, Matt = 1, Toby = 7, Ross = 6, Billy = 2),
Milf = list(James = 10, Brad = 4, Kevin = 5, Shep = 9, Drew = 11, Tony = 7,
Milf = 12, Keith = 3, Matt = 6, Toby = 8, Ross = 1, Billy = 2),
Toby = list(James = 3, Brad = 1, Kevin = 11, Shep = 5, Drew = 2, Tony = 9,
Milf = 10, Keith = 8, Matt = 7, Toby = 12, Ross = 6, Billy = 4),
James = list(James = 12, Brad = 4, Kevin = 3, Shep = 2, Drew = 7, Tony = 1,
Milf = 9, Keith = 6, Matt = 8, Toby = 5, Ross = 11, Billy = 10),
Brad = list(James = 3, Brad = 12, Kevin = 6, Shep = 10, Drew = 1, Tony = 2,
Milf = 9, Keith = 7, Matt = 5, Toby = 11, Ross = 4, Billy = 8),
Ross = list(James = 9, Brad = 7, Kevin = 5, Shep = 12, Drew = 11, Tony = 6,
Milf = 3, Keith = 8, Matt = 4, Toby = 10, Ross = 1, Billy = 2),
Keith = list(James = 9, Brad = 3, Kevin = 1, Shep = 4, Drew = NA, Tony = 8,
Milf = 7, Keith = NA, Matt = 2, Toby = 6, Ross = 5, Billy = 10),
Shep = list(James = 8, Brad = 3, Kevin = 6, Shep = 1, Drew = NA, Tony = 10,
Milf = 9, Keith = 2, Matt = 11, Toby = 5, Ross = 12, Billy = 4),
Drew = list(James = 7, Brad = 2, Kevin = 4, Shep = 10, Drew = 1, Tony = 3,
Milf = 12, Keith = 11, Matt = 8, Toby = 6, Ross = 9, Billy = 5),
Kevin = list(James = 7, Brad = 6, Kevin = 12, Shep = 8, Drew = 9, Tony = 3,
Milf = 4, Keith = 1, Matt = 2, Toby = 5, Ross = 10, Billy = 11)
)
rival_df <- map2(survey_results, names(survey_results), function(x, y) {
as_tibble(x) %>%
gather(rival, rank) %>%
mutate(owner = y)
}) %>%
bind_rows()
View(rival_df)
rival_df %>%
group_by(rival) %>%
summarise(score = 12 - mean(rank)) %>%
ggplot(aes(x = score, y = rival)) +
geom_bar()
rival_df %>%
group_by(rival) %>%
summarise(score = 12 - mean(rank)) %>%
ggplot(aes(x = score, y = rival)) +
geom_bar(stat = "identity")
rival_df %>%
group_by(rival) %>%
summarise(score = 12 - mean(rank)) %>%
ggplot(aes(x = rival, y = score)) +
geom_bar(stat = "identity")
rival_df %>%
group_by(rival) %>%
summarise(score = 12 - mean(rank, na.rm = TRUE)) %>%
ggplot(aes(x = rival, y = score)) +
geom_bar(stat = "identity")
rival_df %>%
group_by(rival) %>%
summarise(score = 12 - mean(rank, na.rm = TRUE))
rival_df %>%
group_by(rival) %>%
summarise(score = 12 - mean(rank, na.rm = TRUE)) %>%
ggplot(aes(x = rival, y = score)) +
geom_bar(stat = "identity")
rival_df %>%
group_by(rival) %>%
summarise(score = 13 - mean(rank, na.rm = TRUE))
rival_df %>%
group_by(rival) %>%
summarise(score = 13 - mean(rank, na.rm = TRUE)) %>%
ggplot(aes(x = rival, y = score)) +
geom_bar(stat = "identity")
